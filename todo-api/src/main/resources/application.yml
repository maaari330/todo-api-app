---
spring:
  config:
    import:
      - optional:file:../.env[.properties]
  application:
    name: todo-api
  profiles:
    # デフォルトで dev プロファイルを有効にする
    active: dev
  datasource:
    # Dockerのコンテナ内でのMySQL接続URL
    url: jdbc:mysql://db:3306/todo?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC&characterEncoding=utf8
    username: ${SPRING_DATASOURCE_USERNAME}
    password: ${MYSQL_ROOT_PASSWORD}
    driver-class-name: com.mysql.cj.jdbc.Driver
  jpa:
    hibernate:
      # DBスキーマとエンティティの整合性だけ起動時に検証、HibernateでのDB作成・更新はしない
      ddl-auto: validate
      naming:
        physical-strategy: org.springframework.boot.orm.jpa.hibernate.SpringPhysicalNamingStrategy
        implicit-strategy: org.springframework.boot.orm.jpa.hibernate.SpringImplicitNamingStrategy
    properties:
      hibernate:
      dialect: org.hibernate.dialect.MySQLDialect
    show-sql: true
  flyway:
    enabled: true
    locations: classpath:db/migration
  security:
    user:
      name: ${ACTUATOR_USER}
      password: ${ACTUATOR_PASSWORD}
  task:
    scheduling:
      pool:
        size: ${SCHEDULER_POOL_SIZE}

springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    # UI の起動パス
    path: /swagger-ui.html
    # GET→POST→…の順にソート
    operationsSorter: method

server:
  error:
    # エラーレスポンスに例外メッセージを含める
    include-message: always
    # エラーレスポンスにスタックトレースを含める
    include-stacktrace: always

jwt:
  secretKey: ${JWT_SECRETKEY}
  expiration: ${JWT_EXPIRATION}

# 通知ジョブ設定
notify:
  scan-ms: ${NOTIFY_SCAN_MS}

# VAPID（Web Push）の設定
vapid:
  publicKey: ${VAPID_PUBLIC_KEY} 
  privateKey: ${VAPID_PRIVATE_KEY}
  subject: ${VAPID_SUBJECT} 

logging:
  level:
    '[org.springframework.http.converter.json]': DEBUG
    '[org.springframework.security]': DEBUG
    '[org.springframework.web]': DEBUG
    '[org.hibernate.orm.jdbc.bind]': TRACE
    '[com.example.todoapi]': INFO
    '[com.example.todoapi.notification]': INFO
    '[com.example.todoapi.push]': INFO
    '[nl.martijndwars.webpush]': WARN